<!-- This document was created with HomeSite v2.0 -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<HTML>
<HEAD>
<TITLE>Занимательная вирусология</TITLE>

<style type="text/css">
   BODY {font-family:Arial; font-size:10pt;margin-left:40;margin-right:40}
   TD {font-family:Arial; font-size:10pt}
   P {font-family:Arial; font-size:10pt;text-align:justify}
   LI {font-family:Arial; font-size:10pt}
</style>

</HEAD>

<BODY BGCOLOR=#C8C890>

<A NAME="m0">

<TABLE ALIGN=CENTER CELLPADDING=20 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT SIZE=+3 COLOR="White">Занимательная вирусология. Часть 4</FONT>
</TABLE>

<p><center><b><font color="white">
Внимание! У сайта два зеркала: <a href="http://drmad.chat.ru/">http://drmad.chat.ru</a> и 
<a href="index.html">http://www.nf-team.org/drmad/kostya/<a>.
Возможно, на одном из них лежит более свежий вариант этой страницы! 
</font></b></center></p>
<P ALIGN=RIGHT><A HREF="virii.html">[ На обложку "Занимательной вирусологии" ]</A></P>

<H2 ALIGN=CENTER>Милостивые государи!</A></H2> 

<p>	
<FONT SIZE=+2 COLOR="Green"><STRONG>С</STRONG></FONT> ума сойти! Уже четвертый
выпуск <STRONG>"Занимательной Вирусологии"</STRONG>! С каждым годом ситуация в мире вирусов
становится все занимательней. Приходится поспевать!
</p>

<table width="100%">
<td>
<IMG SRC="juk.gif" ALIGN=LEFT HSPACE=5 VSPACE=5  WIDTH=120 HEIGHT=160 ALT="Жучила"> 
</td>

<td>
<OL>
<LI><P><A HREF="#m1">Хит-парад XX века</A>
<LI><P><A HREF="#m2">Музей половых органов</A>
<LI><P><A HREF="#m3">Еще одна книжка</A>
<LI><P><A HREF="#m4">Осторожно: журналюги!</A>
<LI><P><A HREF="#m5">Анюткины прелести</A>
<LI><P><A HREF="#m6">Ода бЗдительности</A>
<LI><P><A HREF="#m7">ШБ МНК или Тренируйте зрение</A>
<LI><P><A HREF="#m8">SGWW кирдык</A>
<LI><P><A HREF="#m9">Первый отечественный вирус</A>
<LI><P><A HREF="#m10">...Лучше AVP-ей и DrWEB-ов...</A>
<LI><P><A HREF="#m11">Лица с обложки</A>
<LI><P><A HREF="#m12">Идем копать червей</A>
<LI><P><A HREF="#m13">Как устроен антивирус?</A>
</OL>
</td>
<td valign="top">
<strong>Заодно загляните сюда:</strong> 
<p>
<a href="http://www.nf-team.org/drmad/stuff/index.html"><img src="logo_5.gif" alt="DrMADское барахло"></a>
<a href="http://www.nf-team.org/drmad/howcat/index.html"><img src="logo_0.gif" alt="How 2 catch 4rus"></a>
<a href="http://www.nf-team.org/drmad/zf/index.html"><img src="logo_6.gif" alt="Земский Фершал"></a>
</p>
</td>
</table>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m1">1. Хит-парад XX века</FONT></A>
</TABLE>
<p><FONT SIZE=+2 COLOR="Green"><STRONG>В</STRONG></FONT> конце 2000-го года было
очень модно проводить всяческие опросы и составлять по их результатам хит-парады уходящего века:
хит-парад рок-звезд, кинофильмов,  компьютерных игр, футболистов...
</p>
<p>
На мой взгляд, результаты опросов очень сильно зависят от того, кто на них отвечает. У 90-летних
дедушек ответы будут одни, а у 15-летних девочек - совсем другие. Поэтому и выглядят опубликованные
хит-парады подчас бредово. Врядли Шевченко намного лучше Блохина, просто надо было пораньше
родиться, посмотреть игру того и другого, а потом уже сравнивать. "Брат-2", конечно, круто, но
дикого успеха "Чапаева", "Джентельменов удачи", "Экипажа" и пр.  ему врядли  повторить. А 
"Мумий Троллю" до "Машины времени" еще лет 20 расти. И так во всем. Но особенно меня задели 
вирусные хит-парады. Такое ощущение, что их составляли люди, наскоро перелиставшие компьютерные 
журнальцы за последние несколько месяцев - и все. Поэтому я решил составить собственный хит-парад.
</p>

<p>
1. Почти все вирусы 1986-89 гг. создания. Просто потому, что их тогда было немного, и они были
практически на каждой машине.  Странно выбирать из них более или  менее крутые. Все они крутые,
потому что - первые в истории. Это: и загрузочный вирус <strong>Brain</strong>, и <strong>Lehigh</strong>, 
и нерезидентный "pathsearcher"  <strong>Vienna.648</strong>, и резидентники семейств <strong>Jerusalem</strong>
 и <strong>Cascade</strong>...
</p>

<p>
2. Загрузочный "новозеландец"  <strong>Stoned</strong>. В конце 80-х - начале 90-х он сам пугал юзеров "окаменением"
компьютера и предлагал легализовать марихуану. Позже резвились его многочисленные "дети" -
это и <strong>Michelangelo</strong>, и <strong>AntiEXE</strong>, и <strong>J&M</strong>, и многие
 десятки других, почти буквальных подражаний первоначальному оригиналу.
</p>

<p>
3. <strong>Вирус Морриса</strong>. Сетевой червь, распространившийся в ноябре 1989 г. на более чем 6000 
американских, канадских и австралийских компьютеров. Опередил свое время лет на 8-10. Вызвал огромный
резонанс.
</p>

<p>
4. <strong>Doodle.2885</strong> (<strong>M2C</strong>). "Болгарин", родившийся в самом начале 90-х годов и благодаря тщательности
реализации просуществовавший в "дикой природе" лет пять, оглашая окрестности  бодрым американским 
маршем "Yankee Doodle Dandy".
</p>

<p>
5.<strong> Dir-II </strong>(<strong>Driver.1024</strong>). Весьма нетривиальный с точки зрения заложенных в него идей вирус.
Видимо, вирусологи долгое время просто не знали, что с ним делать, поэтому в 1992 году
он пропутешествовал по всему земному шару.
</p>

<p>
6. <strong>OneHalf.3544</strong>. Не самый первый, не самый крутой, но поистине великий полиморфик. В середине
90-х ухитрился побывать чуть ли не на  каждой машине в мире. Более поздние полиморфные
монстры, - и <strong>Natas</strong>, и  <strong>NutCracker</strong>, и <strong>Kaczor</strong>, и многие другие, -
 все кормились идеями, почерпнутыми в "Половинке". 
</p>

<p>
7. <strong>Concept</strong>.  Первый в истории макровирус, очутившийся в дикой природе. 
</p>

<p>
8. <strong>Cap</strong>.Тоже макровирус от 1997 года. Вроде ничего особенного... но перезаражал всех и все,
и временами встречается до сих пор.
</p>

<p>
9. <strong>Cih</strong> (<strong>Чернобыль</strong>). Видимо, в представлении не нуждается. Довольно плодовитый и самый
пока разрушительный вирус в истории.
</p>

<p>
Может быть, кого-то удивит отсутствие в этом списке некоторых известных вирусов. Но нельзя же
объять необъятное, а в список попали только "самые-самые", известные и среди вирусологов, и среди
юзеров. Например, <strong>3APA3A</strong>, так потрясшая мир антивирусников, ничем особенным в дикой
природе так и не отметилась. Наоборот, крайне плодовитый <strong>Burglar.1150</strong> внутри сер, как сто мышей,
и абсолютно неинтересен. А довольно хитрая и  "заразючая" <strong>Tequila.2468</strong> не вызовет никаких эмоций
у нашего соотечественника, - зверствовала она только за бугром.
</p>

<p>
Не стоит расстраиваться. Новый век принесет немало новых великих событий в мире вирусов, не
сомневайтесь!
</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>


<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m2">2. Музей половых органов</FONT></A>
</TABLE>

<p><FONT SIZE=+2 COLOR="Green"><STRONG>Р</STRONG></FONT>ечь, конечно, не о гинекологии. :-)
Речь об эволюции механизмов размножения макровирусов.</p>

<p>Первые макровирусы, такие как <strong>WM.Cap</strong>, писались на <strong>WordBasic</strong>-е и заражали документы,
сформированные <strong>MS WinWord 6.0</strong> или <strong>7.0</strong>. Механизм размножения был основан
на идее копирования макросов из шаблона (template)  в документ и обратно при помощи команды</p>

<div align="center"><strong>MacroCopy  Откуда, Куда, [ФлагШифровки].</strong></div>

<p><strong>WinWord 97</strong> прекрасно воспиринимал и выполнял макросы, написанные на <strong>WordBasic</strong>-е... но не все! Как раз
<strong>[WordBasic].MacroCopy</strong> был отключен! Но "родным" языком для версии 97-го года был не WordBasic,
а <strong>Visual Basic for Application (VBA)</strong>. А в нем, разумеется, существовали собственные средства для копирования
макросов - команда</p> 

<strong><div align="center">Application.OrganizerCopy</div></strong>.

<p>
Недолго музыка играла, очень недолго. Буквально сразу же <strong>Microsoft</strong> выпустила заплатку SR1, наглухо зашивающую пасть
этой команде. Это произошло так быстро, что русифицированная версия <strong>WinWord 9</strong>7, на которой мы все работаем,
вышла в одном флаконе с заплаткой (она сама не встает, ее надо инсталлировать отдельно!).
</p>

<p>
Поэтому вирусописателям пришлось искать новую дырку. Ей стала пара команд
</p>

<div align="center">
<strong>Application.VBE.ActiveVBProject.VBComponents.Export ИмяФайла</strong><br>
и<br>
<strong>ActiveDocument.VBProject.VBComponents.Import(ИмяФайла)</strong><br>
</div>

<p>Иногда вторая в этой паре команда может быть заменена на что-то вроде</p>

<div align="center"><strong>Host.Codemodule.AddFromFile (ИмяФайла)</strong>.</div>

<p>Вирусы, внедренные в документ таким образом, не видны при помощи редактора макросов,
но прекрасно обаруживаются при помощи FAR-овского плагина DocVIEW.</p>

<p>
Последние способы заражения актуальны до сих пор, даже и в версии от 2000 года. 
Если Вы хотите проверить, являются ли макросы в полученном
вами документе вирусными или нет - ищите эти команды.
 </p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>


<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m3">3. Еще одна книжка</FONT></A>
</TABLE>
<p><FONT SIZE=+2 COLOR="Green"><STRONG>Н</STRONG></FONT>азывается она "Энциклопедия компьютерных
вирусов" и вышла в издательстве "Солон-Р". Авторы: два А. Парандовских и один Д.Козлов. 
В свой <a href="virus3.html#m1">список литературы</a> я ее уже вставил.

<p>
 Один из авторов сам написал мне и попросил разрешния использовать материалы
из моей статьи <a href="http://virus.komi.ru/howcat/index.htm">"Как Пымать Выря За Хвост"</a>.  Я не возражал, и 
поэтому про то, что из этого "использования" получилось, говорить не буду.
</p>

<p>
Зато упомяну, что легко  опознал в тексте книжки огромные куски и фрагменты из "Компьютерной вирусологии" 
Н.Н. Безрукова, из "Как написать компьютерный вирус" И.Коваля и из все той же "Пишем вирус и антивирус" И.Гульева.
 Кроме того, при чтении  невероятно раздражают следующие обстоятельства:

<ul>
<li> текст в книжке крайне нахально звучит от первого лица: "я провел эксперименты", "я обнаружил", "я придумал" и т.п.;
<li>между тем,  авторы настолько не понимают того, чего напионерили, что некоторые наспех порезанные 
и сикось-накось склеенные фрагменты чужих текстов читать без жалостливой ухмылки трудно;
<li>сама книжка оформлена просто отвратительно - опечатки, "поехавшие" строки и абзацы, сваленные
в кучу цифры из таблиц и т.п. - сплошь и рядом.
</ul>

<p>
Эта книжка еще лежит в магазинах, но несмотря на "жареное" название никто ее нахрен не берет. 
Потому что - макулатура.
</p>

</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m4">4. Осторожно: журналюги!</FONT></A>
</TABLE>

<p>
<table cellspacing="2" cellpadding="2" border="0">
<tr>
    <td width="50%"></td>
    <td width="50%">
<i>
"О чем бы разговор ни был, он всегда умел поддержать его: шла ли речь о лошадином заводе;
говорили ли о хороших собаках, и здесь он сообщал очень дельные замечания;...было ли
рассуждение о бильярдной игре - и в бильярдной игре он не давал промаха; говорили ли
о добродетели, и о добродетели рассуждал он очень хорошо, даже со слезами на глазах..."<br>
Н.В. Гоголь. Мертвые души.
</i>
</td>
</tr>
</table>
</p>

<p><FONT SIZE=+2 COLOR="Green"><STRONG>Е</STRONG></FONT>сть такая очень распространенная и очень
опасная болезнь - <strong>Синдром Ложной Компетентности</strong>. Ей даже целый сайт посвящен: 
<a href="http://kumite.com/myths">http://kumite.com/myths</a>. Основное проявление - это когда солидные и уважаемые 
(на первый взгляд)  люди начинают с видом ученой лошади очень серьезно и веско рассуждать о вещах... в которых
абсолютно ничего не смыслят. Страшно, что их читают и им верят.</p>

<p>
Вот несколько примеров. Очень надеюсь, что мне в дальнейшем не придется добавлять новые абзацы в этот
раздел. Хотя в это верится слабо. :-(
</p>

<p>
Пример 1.  <a href="http://www.pcweek.ru/news.asp?id=453&amp;page=2">http://www.pcweek.ru/news.asp?id=453&page=2</a>
</p>

<strong>
<p>Леонид Черняк:...Питер Типпетт (Peter Tippett), президент компании ICSA, входящей в состав Gartner Group и анализирующей 
состояние дел в компьютерной вирусологии, считает, что к появлению нового поколения вирусов нужно отнестись 
со всей серьезностью. Неблагополучие в области компьютерных вирусов достигает критических пределов.
 Основанием для такого мнения является обследование более полумиллиона настольных рабочих станций, проведенное 
ICSA в 1998 г. Оно показало наличие той или иной формы инфекции в 99% ПК.
В своих методиках ICSA делит вирусы на три поколения. 
Первое зародилось в 1986 г., когда на смену теоретическому представлению пришли практически реализованные 
вирусы Jerusalem, Form и Michelangelo, заражавшие только файлы .exe...
</p>
</strong>

<p>
 Кошмарные цифры, да? Девяносто девять процентов! Не мудрено, что доверчивые юзеры, прочитав <strong>такое</strong>,
хлопаются в обморок при звуках слова "вирус", а потом выкладывают свои последние доллары за свежие НортонАнтивирусы
и ДокторыСоломоны. Тем не менее, уровень "компетентности" автора виден без телескопа. Перечитайте-ка последнюю
фразу... Из трех перечисленных вирусов два являются загрузочными, и потому <strong>в принципе на заражают "файлы .exe"</strong>! 
Оказывается, уважаемый президент компании ICSA умеет только "президентствовать", и не слишком даже понимает,
какими такими "вирусами" его компания занимается. Тем не менее, у него взяли интервью, растиражировали в Америке,
потом перевелии на русский, растиражировали в России, кто-то с умильными соплями на глазах уже поверил "известному
специалисту"... Грустно. :-(
</p>

<p>
Пример 2. <a href="http://www.2000-online.ru/current_issue/computer/right.asp">Http://www.2000-online.ru/current_issue/computer/right.asp</a>
<p>

<p>
<strong>
Вирус Норриса. 
<br>
...Повальная эпидемия сетевого вируса Норриса (другое название - С Internet Worm) в ноябре 1988 года поразила более 
6000 компьютерных систем в США (включая NASA Research Institute) и практически парализовала их работу. По 
причине ошибки в коде вируса он... неограниченно рассылал свои копии по другим компьютерам Сети и таким образом 
полностью забирал под себя ее ресурсы. Общие убытки от вируса Норриса были оценены в 96 миллионов долларов... 
</strong>
</p>

<p>
Обратите внимание - какая строгая и  четкая  лексика! Солидный автор, возможно даже в очках и в шляпе!
Не доверять ему просто невозможно...
</p>

<p>
Смущает только, что "вируса <font face="" color="Red">Н</font>орриса" в природе никогда не существовало, а был
"вирус Морриса". Выходит, наш "солидный" и "компетентный" автор про вирусы услышал  первый раз в  жизни накануне,
причем, вероятно, от человека с сильно заплетающимся языком. И сразу после этого кинулся писать "крррутой 
аналитический обзор". 
</p>

<p>
Пример 3. <a href="http://www.osp.ru/cw/2000/46/036_0.htm">Http://www.osp.ru/cw/2000/46/036_0.htm</a>
</p>

<p>
<strong>
Cара Гордон: ...Вирусописатели -   это   самое   дно   особой
иерархии компьютерного  андеграунда,  вершину
которой занимают хакеры. Большинство хакеров,
даже писавшие вирусы ранее,  свысока  смотрят
на  тех,  кто  этим  занимается...
</strong>
</p>

<p>Вот те раз, подумал Штирлиц. Все в точности поставлено с головы на ноги. Или "известная американская специалистка
по психологии вирусописателей" слегка трехнутая, или...</p>

<p>Смотрим <a href="http://www.cnews.ru/topnews/2001/05/08/content5.shtml">
Http://www.cnews.ru/topnews/2001/05/08/content5.shtml</a>:</p>

<strong>
<p>
...Для того, чтобы данное занятие 
потеряло свою привлекательность в глазах подростков и молодых людей, им нужно доказать, 
что это - вовсе не престижное занятие. Кроме того, отношение к вирусописательству, как 
к преступлению, нужно воспитывать с детства...
</p>
</strong>

<div align="center"><img src="sarah.jpg" border=0 alt="Сара Гордон"></div>

<p>
Оказывается, г-жа Гордон совсем и не ошиблась в первый раз. Это нарочно. Это она просто "солгала во спасение".  В ее "творчестве" направо и налево 
присутствует двойной
стандарт. Может быть, романтика вирусописательства действительно в какой-то мере является фальшивой. Так докажи это!
Продемонстрируй подлинную романтику, покажи на конкретных примерах, что ловить вирусы интересней, чем распространять
 их. Что настраивать 1С:Бухгалтерию и торговать гигабайтами-мегагерцами еще круче. Только не надо
применять рецепты покойного д-ра Геббельса ("чем чудовищнее ложь, тем охотнее люди в нее верят").  От них - воняет, и не только
тленом.
</p>


<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m5">5.  Анюткины прелести</FONT></A>
</TABLE>
<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>E</STRONG></FONT>сть такой вирус - <strong>Анна Курникова</strong>.
Написал его (вернее, сформировал при помощи генератора макровирусов) один 20-летний голландец - Jan de Wit (aka OnTheFly),
быстренько раскидал по мировым эхо-конференциям, дождался очередной истерики среди досмерти 
напуганных пользователей, и побежал сдаваться в полицию. Ну и фиг с ним.
</p>

<p>
"Шутка юмора" в том, что вирус распространялся в виде аттачей с двойным расширением: <strong>AnnaKournikova.JPG.EXE</strong>.
JPG - это картинка, но EXE все-таки смеется позже. Вот так и подзалетели тысячи сексуально озабоченных недоумков,
ожидавших, видимо, увидеть примерно вот такую картинку.
</p>

<div align="center"><img src="anutka.jpg" border=0 alt="Анюткины сиськи"></div>

<p>
 Они не учли, что <strong>такие</strong> прелести нахаляву - не бывают. :-)
</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m6">6. Ода бЗдительности</FONT></A>
</TABLE>
<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>Н</STRONG></FONT>а <strong>mail.chat.ru</strong> установили антивирусный фильтр. 
Прекрасное начинание! Если ко мне пришел по E-mail вирус, предупредите меня! Или даже убейте заразу!
</p>

<p>
Но провайдеры почему-то решили "осчастливить" пользователей дополнительным "сервисом". Без раздумий убиваются
не только вирусы вместе с письмами, но и подозрительные по каким-то причинам вложения. Например, послать
в Москву к Касперскому файл со свежепойманой заразой я уже не смогу: <strong>chat.ru</strong> лучше меня знает, что мне
посылать положено, а чего нет.
</p>

<p>
Доходит до совсем уж анекдотических случаев. Антивирусная компания ДиалогНаука рассылала своим подписчикам
по E-mail обновления вирусных баз. Антивирус не смог распознать формата этих вложений, посчитал их "испорченными"
(да, кстати, "испорченные" файлы тоже, оказывается, крамола!), ну и в результате получилось вот что.
</p>

<p><strong>
Пресс-релиз компании Диалог-Наука.<br>
Помните притчу   Льва   Толстого  про  мальчика  и
волков?   Сожалеем,   что    в    роли    напрасно
потревоженных  людей  оказались некоторые из наших
клиентов.  Они так и не смогли получить  очередное
обновление    программы   Doctor   Web...   Другой
антивирус, проверяющий почту на серверах некоторых
провайдеров,   не   передал   файлы,   потому  что
рассылаемые нами исполняемые модули якобы заражены
вирусом. Каким именно не уточнялось. Заверяем всех
наших клиентов в том,  что в рассылках  обновлений
никаких   вирусов   не   содержалось.  Провайдерам
советуем более критично  относиться  к  сообщениям
программ,    используемых    на    их    серверах.
Производителям  же  антивирусов  желаем  научиться
отличать  зараженные  вирусами  файлы  от  файлов,
разбитых на  части  при  формировании  многотомных
архивов.  Не  превратитесь  в мальчика из грустной
притчи, уважаемые коллеги!
</strong></p>

<p>
Что-то не хочется мне убирать лишнюю букву "З" из заголовка...
</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m7">7.  ШБ МНК или Тренируйте зрение</FONT></A>
</TABLE>
<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>П</STRONG></FONT>омните таблицу:
 <font size="+2">ШБ</font><font size="+1"> МНК</font> ЫМБШ... <font size="-2">НКИБМШИБ</font>? Оказывается, ее можно использовать и для тренировки
остроты зрения.
</p> 

<p>
Потренируем наши глазки - поучимся искать вирусы невооруженным глазом. Ну... почти невооруженным.
Нам понадобится утилита <strong>Hacker View by SEN</strong> (знаменитый <strong>HIEW</strong>) версий 6.0 и старше.
Исследовать будем PE-файлы, т.е. файлы исполнимых программ для <b>Windows 9X</b> и <b>NT</b>.
</p>

<p>
1. Загрузим файл в <strong>Hiew</strong>, нажмем Enter (чтобы сменить режим отображения на 16-ричный,  или, - вторым нажатием, -
на режим дизассемблирования), а потом F8 (чтобы отобразить содержимое специфического заголовка программы). 
</p>

<p>
2. Нам потребуются два числа: <strong>EntryPoint RVA</strong> (относительный адрес точки входа, на картинке он равен 7000)
и <strong>Image Base</strong> (это базовый адрес, по которому программа будет загружена в память, на картинке это 400000).
</p>

<div align="center"><img src="hiew1.jpg" border=0 alt=""></div>

<p>3. Теперь нажмем F6. Появится таблица описания секций программы. Дело в том, что программа состоит
из нескольких секций. Вторая колонка в таблице (<strong>RVA</strong>) - это адрес начала секции в памяти (относительно
<strong>Image Base</strong>). Обычно в здоровых программах точка входа <strong>EntryPoint RVA</strong> указывает в первую по счету 
секцию (т.е. должно быть для нашего примера в пределах между 1000 и 2000), и эта секция называется <strong>.tex</strong>t или <strong>CODE</strong>.</p>

<div align="center"><img src="hiew2.jpg" border=0 alt=""></div>

<p>
4. Посмотрим, что нас должно насторожить:
<ul>
<li>точка входа лежит в секции с нестандартным именем (в нашем случае она находится между 7000 и бесконечностью, 
т.е. в секции с именем .<strong>vlad</strong>);
<li>точка входа лежит в секции со cтандартным именем, но эта секция - последняя по счету (т.е., если бы секции
<strong>.vlad</strong> не существовало, а значение <strong>EntryPoint</strong> указывадо бы внутрь <STRONG>.reloc</STRONG>);
<li>точка входа лежит вообще вне всяких секций (например, если для нашего примера <strong>EntryPoint</strong> меньше 1000);
<li>где-то недалеко от дмзассемблированных команд в точке входа (а перейти на нее можно, нажав F5), видна
знакомая нам по ДОС-вирусам пара команд: 
<pre>
	call Next
Next:
	pop "регистр"
</pre>
</ul>

<p>
В данном случае присутствуют признаки 1,2 и 4. Пора бить тревогу! (Это был вирус <strong>Win95.BOZA</strong>)
</p>

</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m8">8.  SGWW кирдык</FONT></A>
</TR></TH>
</TABLE>

<p>
<table>
<tr><td width="40%"><td><td width="60%"><i><b>
...Я должен был исполнить свой последний долг - убить LovinGOD'а.
"Все будет хорошо...не в этой жизни!" - с такими мыслями я снял сковородку
с плиты и ударил его с размаху по башке, а в руке у меня был нож, чтобы его
добить. Радара и его девчонку я тоже собирался реально замочить -
чтобы свидетелей не оставлять...<br>
(c) Товарищ Садист
</b></i></td></tr>
</table>
</p>

<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>C</STRONG></FONT>амая крупная отечественная группировка вирусописателей
наконец-то прекратила свое существование.
</p>

<p>
Краткая справка для тех, кто не в курсе: <STRONG>Stealth Group World Wide</STRONG> зародилась в середине 90-х годов в Киеве как неформальная 
организация юных програмистов, умеющих писать вирусы. Она обзавелась своим &quot;органом печати&quot; , - журналом 
<STRONG>Infected Voice</STRONG>,- и с чисто тимуровской энергией принялась привлекать в свои ряды новых членов - не только талантливых
программистов, но и бездарных тусовщиков. В лидеры группы быстро выдвинулся некто <A HREF="virus3.html#m2"><STRONG>LovinGOD</STRONG></A>. После отъезда <STRONG>LovinGOD</STRONG>-a 
в Москву группа фактически прекратила свое физическое существование, но в течение нескольких лет сохранялась еще
как минимум в двух ипостасях: <br>
1) как наименование некой то ли банды, то ли секты, которую <STRONG>LovinGOD</STRONG> неоднократно пытался сколотить
из малолетних дурачков;<br>
2) как жупел, который активно использовали журналисты и правоохранительные органы для того, чтобы поддерживать в
массах миф о &quot;зловещих российских хакерах&quot;. <br> 
Весной 2001 г. <STRONG>LovinGOD</STRONG>-у окончательно настоиграло мучительно тужиться в
бесплодных попытках организовать свой &quot;анархистский Комсомол&quot;, и он вроде бы решил на это дело забить, о чем публично и <A HREF="zv_24.zip">заявил</A>. 
</p>

<p>
Так дело выглядит со стороны. Если Вы хотите ознакомиться с историей <STRONG>SGWW</STRONG> глазами самого <STRONG>LovinGOD</STRONG>-а, то загляните
на <A HREF="http://www.redline.ru/~one/">http://www.redline.ru/~one</A>, пока эта страничка еще существует. Если
Вас интересуют впечатления рядовых членов SGWW о своей шайке, а также отмазки LovinGod-а, то скачайте и почитайте 
<a href="zv_26.zip">вот это</a>.</p>

<p><i>
Примечание от весны 2002 г. Тем не менее, сам LovinGod на пенсию опять не вышел. Его 
новый "проект" (см. в <a href="zv_26.zip">том же ZIP-е</a>) претендует уже на мировые масштабы. 
</i></p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>


<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m9">9. Первый отечественный вирус</FONT></A>
</TABLE>

<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>Н</STRONG></FONT>иколай Николаевич Безруков, автор знаменитой
&quot;<A HREF="virus3.html#m1">Компьютерной Вирусологии</A>&quot;, ошибался, когда считал, что первый отечественный вирус был
написан в конце 80-х годов XX века и представлял собой переделку импортного оригинала.
</p>

<p>
На самом деле первый вирус на территории СССР в 1985 г. создал <STRONG>Антон Чижов</STRONG>, известнейший в то время отечественный
программист, сотрудник ВЦ АН СССР, автор справочника - Системное программное обепечение ПЭВМ.
-М.:Финансы и статистика, 1990.- 415 с. 
</p>

<p>
Вот эта история:
</p>

<b>

<p> Первый вирус в России, думаю, написал именно я. Но и антивирус мой тоже был одним из первых.
Было это примерно в 1985 году.</p>

<p> Я работал тогда в ВЦ Академии наук, там была небольшая группа под руководством Виктора
Михайловича Брябрина, занимавшаяся персональными компьютерами. Однажды зовут меня в первый отдел
и говорят, что со мной хочет поговорить товарищ из КГБ, курировавший наш вычислительный центр.
Этот товарищ начал меня расспрашивать о компьютерных вирусах. &quot;В Советском Союзе, — начал он, —
активно развиваются сети передачи данных. В западной прессе появились статьи о компьютерных
вирусах. Хотелось бы знать, насколько это все серьезно&quot;.</p> 

<p> Как программистская задача меня это очень заинтересовало, и я сказал, что попробую разобраться
с тем, что это такое. Начал разбираться, нашёл разные материалы… и тогда взял и попробовал
написать первый вирус.</p>

<p> И я написал вирус, который ничего не делал. Более того, он должен был самоуничтожиться через
год. Правда, происходило это далеко не всегда по той причине, что в компьютерах тогда не было
батарейки, и дату и время надо было каждый раз вводить при запуске системы, что делали далеко не
все. Из-за этого системное время большинства компьютеров было установлено на 80-й год.</p>

<p> Кроме самоуничтожения у моего вируса была специальная функция — он должен был уметь докладывать
специальной программе о своем наличии в системе: &quot;Да, я здесь&quot;. Я забросил этот вирус в систему
и где-то через шесть-семь месяцев начал проверять, куда он успел добраться. По моим оценкам — а
я знал довольно много московских организаций, поскольку наша лаборатория была одной из самых
первых и, соответственно, одной из самых продвинутых по персональным компьютерам в то время —
выходило, что процентов 70 всех компьютеров в Москве были заражены моим вирусом.</p>

<p>Таким образом, вирус распространился довольно быстро и масштабно. Стало понятно, что это очень
серьезно, и я тогда написал антивирус. Звался он &quot;Доктор&quot;, был очень простой и умел ловить
порядка 70 известных мне (в том числе на основе анализа других антивирусных программ) вирусов.</p>

<p>Все эти свои исследования я представил сотруднику КГБ, причем мы с ним некоторое время
препирались относительно формы подачи полученных результатов: он попросил изложить все это на
бумаге, мне же такая идея совсем не нравилась: писать что-то &quot;туда&quot; мне не очень хотелось,
потому что не известно, куда потом пойдут эти рукописи. В конце концов мы договорились, что я
наберу все это на компьютере, распечатаю, но подписываться не буду.</p>

<p> &quot;Доктор&quot; потихонечку стал теряться среди новых появлявшихся антивирусов. Он был поделкой, а
чтобы развиваться, нужно было строить правильный поточный процесс сопровождения. Мы решили этого
не делать, и я нисколько не жалею об этом: был 1988 год, у нас в то время было много других дел.</p>

<p> Антон Чижов</p>

</b>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m10">10. ...Лучше AVP-ей и DrWEB-ов...</FONT></A>
</TABLE>

<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>Е</STRONG></FONT>сли попытаться одним словом
передать нынешнее отношение юзеров к вирусам, то слово это будет: <strong>паника</strong>.
Истеричные вопли, выпученные глаза, потерянная обувь, брошенная ручная кладь...
Оказаться в такой обезумевшей толпе крайне неприятно, но если сидишь где-нибудь
на прочном высоком дереве, все сверху видишь, все понимаешь, то так и тянет
временами что-нибудь такое страшное крикнуть, или этакое громкое свистнуть.
</p>

<p>
Вот шуточная программка <a href="zv_25.zip">awplite</a> из серии &quot;псевдоAidsTest-ов&quot;, 
которую я однажды в час досуга состряпал. В отличие о своих многочисленных аналогов,
пародирующих AidsTest, она имитирует одну из версий популярного антивируса AVP. Совершенно безвредна,
за исключением того, что не слишком внимательного юзера способна довести до
инфаркта, - настолько достоверно выглядит ее работа. 
</p>
<p><div align="center"><img src="awplite.gif" border=0 alt=""></div></p>
<p>
Идеальное средство для
вразумления &quot;компьютерных домомучительниц&quot;. :-)
</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m11">11. Лица с обложки</FONT></A>
</TABLE>

<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>Я</STRONG></FONT> и не ожидал, что так сильно
западет в душу читателей &quot;Занимательной Вирусологии&quot; моя &quot;Третьяковская галерея&quot;.
По крайней мере за два года мне четырежды присылали &quot;абсолютно секретные фотки 
<strong>LovinGod</strong>&quot;-а :-)
</p>

<p>
Трижды это был фотопортрет <strong>Д.Н. Лозинского</strong> из ДиалогНауки.
</p>
<div align="center">
<img src="lozinsky.jpg" border=0 alt="Лозинский" height=75 width=40>
<img src="lozinsky.jpg" border=0 alt="Лозинский" height=75 width=60>
<img src="lozinsky.jpg" border=0 alt="Лозинский" height=75 width=100>
</div>
<p>
Один раз - фотка <b>Арви Хакера</b> из ГШХ.
</p>
<div align="center">
<img src="arvi.jpg" border=0 alt="Арви Хакер" height=100 width=150>
</div>

<p>
Кроме того, "совершенно конфиденциально" мне был раскрыт "страшный секрет": 
настоящее имя <strong>LovinGod</strong>-а - <strong>Крис Касперски</strong>, причем он - то ли сын, то ли брат, то ли 
племянник <strong>Е. Касперского</strong>. Только поэтому его до сих пор еще не посадили :-)
</p>

<center>
<img src="kpnc.gif" border=0 alt="Крис Касперски aka KPNC" height="100" width="80">
</center>

<p>
&quot;Сёма! Я так смеявся, шо тока трохи не упав з кровати&quot;. (Гм... а может, напрасно?) Тем не менее, 
всем, присылавшим фотки и "информацию" - спасибо! :-)
</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>


<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m12">12. Идем копать червей</FONT></A>
</TABLE>

<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>В</STRONG></FONT> наш век молниеносных Интернетовских 
эпидемий очень важно умение <strong>самому</strong> справиться с пришедшей по почте
и расползшейся по  компьютеру заразой. Даже самые навороченные почтовые червяки
часто используют для закрепления в системе довольно ограниченный набор приемов. 
</p>

<ol>
<li>Копируют свой файл в один из каталогов автозапуска: 
в <strong>C:\Windows\Главное меню\Программы\Автозагрузка</strong> или в
<strong>C:\Windows\System\IOSUBSYS</strong>.
<li>Прописывают себя в ключе 
<strong>HKEY_LOCAL_NACHINE\SoftWare\Microsoft\Windows\CurrentVersion\Run</strong> системного реестра.
<p><div align="center"><img src="klez0.gif" border=0 alt=""></div></p>
<li>Прописывают себя в одном из "опасных" ключей <strong>ini</strong>-файлов или в конфигурационных
файлах <strong>CONFIG.SYS</strong>/<strong>AUTOEXEC.BAT</strong>.
<p><div align="center"><img src="configz.gif" border=0 alt=""></div></p>
</ol>

<p>
Очень часто справиться с ними удается при помощи штатной утилиты REGEDIT и любого текстового 
редактора.
</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White"><A NAME="m13">13. Как устроен антивирус?</FONT></A>
</TABLE>

<p>
<FONT SIZE=+2 COLOR="Green"><STRONG>В</STRONG></FONT>ы никогда не задумывались над
подобным вопросом? Давайте восполним этот пробел.
</p>

<p>Самые первые антивирусы писались, видимо, целиком на каких-то языках программирования:
главная программа плюс много-много подпрограммок для обнаружения и лечения конкретных
вирусов. Вероятно, так был устроен, например, знаменитый AidsTest Д.Н. Лозинского.
Это вполне приемлимо, если антивирус рассчитан на два-три варианта &quot;заразы&quot;.
Ну на десять. Ну даже на пятьдесят. Но когда количество вирусов начинает исчисляться 
сотнями и тысячами (а подавляющее большинство их устроено по одним и тем же канонам!),
то обязательно возникает необходимость как-то формализовать этот процесс.</p>

<p>
В самом деле: допустим, перед нами &quot;стандартный&quot; COM-вирус. Алгоритм поиска и 
удаления крайне прост: <ol>
<li>Найти в начале команду JMP и посмотреть, куда она указывает.
<li>В том месте, куда она указывает,  прочитать определенное количество
байтов и сравнить с заранее заготовленно &quot;сигнатурой&quot;.
<li>Если сигнатуры совпадают, то в заранее известном месте внутри
вируса найти &quot;спрятанные&quot; байты из начала программы и
скопировать их на свое &quot;законное&quot; место.
<li>Отрезать от конца файла &quot;хвост&quot;, равный длине вируса.
<li>Все!
</ol>
</p>

<p>
Процедуры поиска и лечения сотни таких вирусов (а их на самом деле, по самым скромным подсчетам,
минимуми в сто раз больше - т.е. десять тысяч!)  отличаются только
несколькими числовыми константами: сигнатурой, позицией спрятанных байтов и длиной
вируса. Чуть более сложные, но тоже стандартные, процедуры получатся в случае EXE-вирусов.
Ненамного усложнится процедура и в случае зашифрованных вирусов. Даже для полиморфиков
можно составить универсальный алгоритм поиска. Макро-вирусы, Win32-вирусы, почтовые черви -
все подвергаются &quot;стандартизации&quot; и &quot;унификации&quot;!
</p>


<p>Отсюда простая идея: антивирус должен представлять собой просто некую исполняющую систему,
некий виртуальный &quot;станок&quot;, работающий по определенной программе. А программу
для него может писать любой желающий в обычном текстовом редакторе в виде множества однотипных 
записей, образующих <strong>вирусную базу</strong> данных.</p>
<p>
Один из первых примеров такого подхода можно найти в пакете Доктор Касперский, распространявшемся
в начале 90-х годов прошлого века. Вот как выглядела отдельная запись базы для лечения COM-вируса:
</p>
<b>
<pre>
Type COM         ; Тип вируса
Name NEW_VIRUS	 ; Имя вируса
...
Cure_Method MOVE ; Метод лечения (перемещение байтов)
Cure_Page DUMMY  ; Страница для удаления вируса -- отсутствует
...
Tail 1234        ; Усекаемая длина вируса     
</pre>
</b>

<p>Похоже выглядели записи в вирусе AVSP (1991-93 гг.):</p>

<b>
<pre>
_Rector
NUMB=81.1-55522
TYPE=PROGRAM
SIZE=400
MASK=BF000157A5A533C08EC0
SCAN=*.* { Opt(End:-56) Mov(MP:33,Head:0,4) Tr(MP:-344) }
TEXT=Злобный ректор заражает все подряд файлы, даже текстовые!
TEXT=Название получил за то, что заразил письмо ректору МГУ Логунову.
TEXT=Из семейства вирусов DM-400 (Copyright-90 и т.п.)
TEXT=Лечение производите, установив маску файлов *.* (клавиша <Shift TAB>)
#_END
</pre>
</b>

<p>
Записи в базах антивируса <a href="http://virus.komi.ru/mscan">MultiScan</a> (Валентин Колесников, 1996-98) описывали правила
поиска и лечения даже для полиморфиков. Но самое интересное, что этот антивирус
умел, сканируя подозрительные файлы, <b>самостоятельно</b> и <b>автоматически</b> 
на основе эвристического анализа кода зараженной программы разрабатывать подобные 
записи для антивирусной базы !!! 
</p>

<p>
<b>
<pre>
.!.:C1260,Chameleon
[супер-полиморфик]
.:00.:16.:5E.:00.:0C 26A7 866D.:89.:0C.:20 A865 8C20.:3.:326
</pre>
</b>
</p>

<p>
Поначалу такие базы распространялись вместе с антивирусами в текстовом виде. Но довольно скоро
выяснилось, что на свете существует немало дебилов, стремящихся уродовать эти базы и 
раздавать своим друзьям и знакомым получившиеся &quot;милые подарочки&quot;. Поэтому язык
вирусных баз превратился во внутрифирменное ноу-хау, а к пользователям стали попадать лишь 
предварительно закодированные варианты этих баз. Несколько раз вирусописателям удавалось
разобраться в кодировке и раскидать по миру подделанные базы, антивирусники отвечали 
введением новых, усиленных алгоритмов шифрования...
</p>

<p>
Короче, мало кто из &quot;нормальных&quot; людей представляет себе, как сейчас, спустя много
лет, выглядят антивирусные базы в своем исходно виде - в том, в каком их разрабатывают
специалисты антивирусных компаний. Впрочем, летом 2002 года работники фирмы Диалог-НАУКА
прокололись и вместе с июльским обновлением DrWeb-а распространили его исходный текст. Если
кому интересно - <a href="zv_27.zip">качайте</a> и разбирайтесь сами.
</p>

<P ALIGN=RIGHT><A HREF="#m0">[На начало]</A></P><BR>

<TABLE ALIGN=CENTER CELLPADDING=6 BGCOLOR="Green" WIDTH="100%">
<TR><TH><FONT COLOR="White">... To be continued ... </FONT>
</TABLE>

</BODY>
</HTML>